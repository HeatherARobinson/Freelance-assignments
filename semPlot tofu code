library(lavaan)
library(semPlot)

Tofu<-read.csv("Tofu2.csv")
attach(Tofu)
varTable(Tofu)

Tofu$Season <- Tofu$Season/10
Tofu$Texture <- Tofu$Texture/10
Tofu$Flavor <- as.character(Tofu$Flavor)
Tofu$Week <- Tofu$Week/100
Tofu$Size<-Tofu$Size/10
Tofu$Sales<-as.numeric(Tofu$Sales)/1000000

tofu.model.f<-'Seasonal =~Major_hol + Other_hol + Season
Type=~Size +Retail+Promo + Temp + New+ Texture+Flavor
Distribution =~Canada + a*SE + a*NE
Texture~~0.0207125*Texture
Flavor~~Temp
Flavor~~SE
Sales~Seasonal+Type+Distribution'

tofu.fit.f<-cfa(model=tofu.model.f, data=Tofu)
summary(tofu.fit.f, standardized=TRUE, fit.measures=TRUE)

tofu.sem<-sem(model=tofu.model.f, data=Tofu)
summary(tofu.sem, standardized=TRUE, fit.measures=TRUE)

semPaths(tofu.fit.f, rotation = 2, what="stand",groups="latents",
color = list(lat = c("LightCyan","Honeydew","LightYellow"),int="black"),
nCharNodes=0, combineGroups=TRUE,nCharEdges=0,sizeMan=12,sizeMan2=6,sizeLat=12,sizeLat2=12,fade=FALSE,edge.color="black")

#layout can be tree, tree2, circle, circle2, spring. We are using the default, which is tree.



